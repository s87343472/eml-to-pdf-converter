# EML到PDF批量转换工具 - UI设计

## 整体布局

应用采用现代、简洁的单页面应用（SPA）设计，主要分为以下几个区域：

1. **顶部导航栏**：包含应用标题、主题切换按钮和帮助按钮
2. **主内容区**：根据当前步骤显示不同内容
3. **底部状态栏**：显示处理状态、进度和版权信息

## 页面结构

```
┌─────────────────────────────────────────────────────────────┐
│                         顶部导航栏                           │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│                                                             │
│                       主内容区                               │
│                                                             │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│                         底部状态栏                           │
└─────────────────────────────────────────────────────────────┘
```

## 主要视图

### 1. 文件上传视图

这是应用的初始视图，用于上传EML文件。

```
┌─────────────────────────────────────────────────────────────┐
│  EML到PDF批量转换工具                          🌙 深色  ❓ 帮助  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │                                                     │    │
│  │                拖放EML文件到这里                      │    │
│  │                                                     │    │
│  │                      或者                           │    │
│  │                                                     │    │
│  │              [ 选择文件 ]  [ 选择文件夹 ]             │    │
│  │                                                     │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
│  已选择的文件 (0)                                            │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │                                                     │    │
│  │               暂无文件，请上传文件                    │    │
│  │                                                     │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
│  [ 开始转换 ]                                               │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  就绪                                           © 2023      │
└─────────────────────────────────────────────────────────────┘
```

### 2. 文件列表视图

当用户上传文件后，显示已上传的文件列表。

```
┌─────────────────────────────────────────────────────────────┐
│  EML到PDF批量转换工具                          🌙 深色  ❓ 帮助  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │                                                     │    │
│  │                拖放EML文件到这里                      │    │
│  │                                                     │    │
│  │                      或者                           │    │
│  │                                                     │    │
│  │              [ 选择文件 ]  [ 选择文件夹 ]             │    │
│  │                                                     │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
│  已选择的文件 (3)                              [ 清空 ]      │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │ ✓ email1.eml                              1.2 MB ❌ │    │
│  │ ✓ email2.eml                              0.5 MB ❌ │    │
│  │ ✓ email3.eml                              2.3 MB ❌ │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
│  [ 配置选项 ▼ ]                              [ 开始转换 ]    │
│  ┌───────────────────────────┐                              │
│  │ 批量大小: 5               │                              │
│  │ 合并PDF: □                │                              │
│  │ 自动打印: □                │                              │
│  │ 页面大小: A4              │                              │
│  └───────────────────────────┘                              │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  就绪 - 已选择3个文件                           © 2023      │
└─────────────────────────────────────────────────────────────┘
```

### 3. 处理中视图

当用户点击"开始转换"按钮后，显示处理进度。

```
┌─────────────────────────────────────────────────────────────┐
│  EML到PDF批量转换工具                          🌙 深色  ❓ 帮助  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  正在处理文件...                                             │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │ ████████████████████████████████████░░░░░░░░░░░░░░░ │    │
│  └─────────────────────────────────────────────────────┘    │
│  2/3 文件 (66%)                                             │
│                                                             │
│  当前处理: email3.eml                                        │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │ 日志:                                               │    │
│  │ [信息] 开始处理文件: email1.eml                       │    │
│  │ [信息] 文件处理完成: email1.eml                       │    │
│  │ [信息] 开始处理文件: email2.eml                       │    │
│  │ [信息] 文件处理完成: email2.eml                       │    │
│  │ [信息] 开始处理文件: email3.eml                       │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
│                                          [ 取消 ]           │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  处理中... 2/3 (66%)                             © 2023     │
└─────────────────────────────────────────────────────────────┘
```

### 4. 结果视图

当所有文件处理完成后，显示处理结果。

```
┌─────────────────────────────────────────────────────────────┐
│  EML到PDF批量转换工具                          🌙 深色  ❓ 帮助  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  处理完成！                                                  │
│                                                             │
│  处理结果:                                                   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │ ✅ email1.eml → email1.pdf                [ 下载 ]  │    │
│  │ ✅ email2.eml → email2.pdf                [ 下载 ]  │    │
│  │ ❌ email3.eml → 失败: 解析错误              [ 详情 ]  │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │ 日志:                                               │    │
│  │ [信息] 开始处理文件: email1.eml                       │    │
│  │ [信息] 文件处理完成: email1.eml                       │    │
│  │ [信息] 开始处理文件: email2.eml                       │    │
│  │ [信息] 文件处理完成: email2.eml                       │    │
│  │ [信息] 开始处理文件: email3.eml                       │    │
│  │ [错误] 处理文件失败: email3.eml - Maximum call...     │    │
│  │ [信息] 所有文件处理完成                               │    │
│  └─────────────────────────────────────────────────────┘    │
│                                                             │
│  [ 下载全部 ]  [ 合并PDF ]                  [ 重新开始 ]     │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  完成 - 成功: 2, 失败: 1                          © 2023    │
└─────────────────────────────────────────────────────────────┘
```

### 5. 错误详情视图

当用户点击失败项的"详情"按钮时，显示详细错误信息。

```
┌─────────────────────────────────────────────────────────────┐
│  EML到PDF批量转换工具                          🌙 深色  ❓ 帮助  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  错误详情                                      [ 关闭 ]      │
│                                                             │
│  文件: email3.eml                                           │
│  错误类型: EmlParseError                                     │
│                                                             │
│  错误消息:                                                   │
│  Maximum call stack size exceeded                           │
│                                                             │
│  堆栈跟踪:                                                   │
│  EmlParseError: Maximum call stack size exceeded            │
│    at parseEmail (emlParser.worker.ts:125:13)               │
│    at processNode (emlParser.worker.ts:78:22)               │
│    at parseEmail (emlParser.worker.ts:130:18)               │
│    ...                                                      │
│                                                             │
│  建议解决方案:                                               │
│  1. 尝试减小批量大小                                         │
│  2. 检查邮件是否包含过于复杂的结构                            │
│  3. 尝试使用其他邮件查看器打开此邮件                          │
│                                                             │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  查看错误详情                                     © 2023     │
└─────────────────────────────────────────────────────────────┘
```

### 6. 帮助视图

当用户点击帮助按钮时，显示帮助信息。

```
┌─────────────────────────────────────────────────────────────┐
│  EML到PDF批量转换工具                          🌙 深色  ❓ 帮助  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  帮助                                         [ 关闭 ]      │
│                                                             │
│  使用指南:                                                   │
│                                                             │
│  1. 上传文件                                                │
│     - 拖放EML文件到上传区域                                  │
│     - 或点击"选择文件"按钮选择单个或多个EML文件               │
│     - 或点击"选择文件夹"按钮选择包含EML文件的文件夹           │
│                                                             │
│  2. 配置选项                                                │
│     - 批量大小: 每批处理的文件数量                           │
│     - 合并PDF: 是否将所有PDF合并为一个文件                   │
│     - 自动打印: 是否自动打印生成的PDF                        │
│     - 页面大小: 选择PDF页面大小                              │
│                                                             │
│  3. 开始转换                                                │
│     - 点击"开始转换"按钮开始处理                             │
│     - 处理过程中可以查看进度和日志                           │
│     - 可以随时点击"取消"按钮停止处理                         │
│                                                             │
│  4. 下载结果                                                │
│     - 处理完成后，可以下载单个PDF或全部PDF                   │
│     - 也可以将所有PDF合并为一个文件下载                      │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  查看帮助                                        © 2023     │
└─────────────────────────────────────────────────────────────┘
```

## 组件设计

### 1. FileUploader 组件

文件上传区域，支持拖放和文件选择。

**属性**:
- `onFilesSelected`: 文件选择回调函数
- `maxFileSize`: 最大文件大小限制
- `acceptedFileTypes`: 接受的文件类型
- `multiple`: 是否允许多选
- `allowFolders`: 是否允许选择文件夹

**状态**:
- `isDragging`: 是否正在拖放
- `isOverSizeLimit`: 是否超过大小限制
- `isWrongFileType`: 是否为错误的文件类型

**交互**:
- 拖放文件时显示视觉反馈
- 文件类型或大小不符合要求时显示错误提示
- 成功选择文件后触发回调函数

### 2. FileList 组件

显示已上传的文件列表，支持移除单个文件或清空所有文件。

**属性**:
- `files`: 文件数组
- `onRemoveFile`: 移除文件回调函数
- `onClearFiles`: 清空文件回调函数

**交互**:
- 点击文件旁的删除按钮移除单个文件
- 点击"清空"按钮移除所有文件
- 显示文件名和大小信息

### 3. ConfigPanel 组件

配置转换选项的面板。

**属性**:
- `config`: 当前配置对象
- `onConfigChange`: 配置变更回调函数

**配置项**:
- 批量大小: 数字输入框，默认5
- 合并PDF: 复选框，默认不选中
- 自动打印: 复选框，默认不选中
- 页面大小: 下拉选择框，选项包括A4、Letter、Legal

**交互**:
- 点击"配置选项"按钮展开/折叠配置面板
- 修改配置后自动保存

### 4. ProgressBar 组件

显示处理进度的进度条。

**属性**:
- `value`: 当前进度值（0-100）
- `total`: 总文件数
- `processed`: 已处理文件数
- `currentFile`: 当前处理的文件名

**交互**:
- 进度条随处理进度动态更新
- 显示百分比和已处理/总文件数

### 5. LogViewer 组件

显示处理日志的组件。

**属性**:
- `logs`: 日志数组
- `maxLines`: 最大显示行数
- `autoScroll`: 是否自动滚动到最新日志

**交互**:
- 不同级别的日志使用不同颜色显示（信息、警告、错误）
- 支持自动滚动到最新日志
- 支持复制日志内容

### 6. ResultList 组件

显示处理结果的列表。

**属性**:
- `results`: 结果数组
- `onDownload`: 下载回调函数
- `onShowDetails`: 显示详情回调函数

**交互**:
- 成功项显示绿色对勾和下载按钮
- 失败项显示红色叉号和详情按钮
- 点击下载按钮下载对应的PDF文件
- 点击详情按钮显示错误详情

## 交互流程

1. **初始状态**:
   - 显示文件上传视图
   - 用户可以拖放文件、选择文件或文件夹

2. **文件上传后**:
   - 显示已上传文件列表
   - 用户可以移除文件、清空列表
   - 用户可以配置转换选项
   - 用户可以点击"开始转换"按钮

3. **处理过程中**:
   - 显示处理进度条和当前处理的文件
   - 显示实时日志
   - 用户可以点击"取消"按钮停止处理

4. **处理完成后**:
   - 显示处理结果列表
   - 用户可以下载单个PDF、下载全部PDF或合并PDF
   - 用户可以查看失败项的详细错误信息
   - 用户可以点击"重新开始"按钮返回初始状态

5. **错误处理**:
   - 文件类型错误: 显示错误提示，不添加到文件列表
   - 文件大小超限: 显示错误提示，不添加到文件列表
   - 处理失败: 在结果列表中显示失败项，提供详情查看

## 响应式设计

应用采用响应式设计，适应不同屏幕尺寸：

1. **桌面设备** (宽度 > 1024px):
   - 使用上述标准布局
   - 文件上传区域和文件列表并排显示

2. **平板设备** (768px < 宽度 <= 1024px):
   - 文件上传区域和文件列表垂直排列
   - 配置面板可能需要点击展开

3. **移动设备** (宽度 <= 768px):
   - 简化布局，所有元素垂直排列
   - 配置选项通过模态对话框显示
   - 日志查看通过单独页面显示

## 可访问性设计

为确保应用符合WCAG 2.1 AA级别的无障碍标准：

1. **键盘导航**:
   - 所有交互元素可通过键盘访问
   - 使用清晰的焦点样式
   - 提供键盘快捷键

2. **屏幕阅读器支持**:
   - 所有UI元素提供适当的ARIA标签
   - 动态内容变化时提供适当的通知
   - 错误消息与相关表单字段关联

3. **颜色对比度**:
   - 确保文本和背景之间有足够的对比度
   - 不仅依靠颜色传达信息（使用图标和文本）

4. **文本大小和间距**:
   - 使用相对单位（rem/em）定义文本大小
   - 提供足够的点击/触摸目标大小和间距

## 主题支持

应用支持浅色和深色两种主题：

1. **浅色主题**:
   - 背景: 白色 (#FFFFFF)
   - 文本: 深灰色 (#333333)
   - 主色: 蓝色 (#3B82F6)
   - 成功色: 绿色 (#10B981)
   - 错误色: 红色 (#EF4444)
   - 警告色: 黄色 (#F59E0B)

2. **深色主题**:
   - 背景: 深灰色 (#1F2937)
   - 文本: 浅灰色 (#F3F4F6)
   - 主色: 蓝色 (#60A5FA)
   - 成功色: 绿色 (#34D399)
   - 错误色: 红色 (#F87171)
   - 警告色: 黄色 (#FBBF24)

主题切换按钮位于顶部导航栏，点击后立即切换主题。应用会记住用户的主题偏好，并在下次访问时自动应用。 